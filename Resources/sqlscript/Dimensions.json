{
	"name": "Dimensions",
	"properties": {
		"content": {
			"query": "--------------\n--Dimensions--\n--------------\nSELECT top 100 * from silver.retail;\n\n--DimDate--\nCREATE EXTERNAL TABLE gold.DimDate\nWITH (\n    LOCATION = 'DimDate',\n    DATA_SOURCE = gold_source,\n    FILE_FORMAT = parquet\n)\nAS\nSELECT DISTINCT\n    CAST(FORMAT(CAST([Date] AS DATE), 'yyyyMMdd') AS INT) AS DateKey,\n    CAST([Date] AS DATE) AS FullDate,\n    [Year],\n    [Month]\nFROM silver.retail;\n\n--DimCustomer--\nCREATE EXTERNAL TABLE gold.DimCustomer\nWITH (\n    LOCATION = 'DimCustomer',\n    DATA_SOURCE = gold_source,\n    FILE_FORMAT = parquet\n)\nAS\nSELECT DISTINCT\n    ABS(\n        CAST(\n            SUBSTRING(\n                HASHBYTES('SHA2_256', UPPER(TRIM(Customer_Name))),\n                1, 8\n            ) AS BIGINT\n        )\n    ) AS CustomerKey,\n    UPPER(TRIM(Customer_Name)) AS Customer_Name,\n    Customer_Category\nFROM silver.retail\nWHERE Customer_Name IS NOT NULL;\n\n--DimProduct--\nCREATE EXTERNAL TABLE gold.DimProduct\nWITH (\n    LOCATION = 'DimProduct',\n    DATA_SOURCE = gold_source,\n    FILE_FORMAT = parquet\n)\nAS\nSELECT DISTINCT\n    ABS(\n        CAST(\n            SUBSTRING(\n                HASHBYTES('SHA2_256', UPPER(TRIM(Product))),\n                1, 8\n            ) AS BIGINT\n        )\n    ) AS ProductKey,\n    UPPER(TRIM(Product)) AS Product_Name\nFROM silver.retail\nWHERE Product IS NOT NULL;\n\n\n--DimStore--\nCREATE EXTERNAL TABLE gold.DimStore\nWITH (\n    LOCATION = 'DimStore',\n    DATA_SOURCE = gold_source,\n    FILE_FORMAT = parquet\n)\nAS\nSELECT DISTINCT\n    ABS(\n        CAST(\n            SUBSTRING(\n                HASHBYTES(\n                    'SHA2_256',\n                    UPPER(TRIM(City)) + '|' + UPPER(TRIM(Store_Type))\n                ),\n                1, 8\n            ) AS BIGINT\n        )\n    ) AS StoreKey,\n    UPPER(TRIM(City)) AS City,\n    UPPER(TRIM(Store_Type)) AS Store_Type\nFROM silver.retail\nWHERE City IS NOT NULL\n  AND Store_Type IS NOT NULL;\n\n\n--DimPromotion--\nCREATE EXTERNAL TABLE gold.DimPromotion\nWITH (\n    LOCATION = 'DimPromotion',\n    DATA_SOURCE = gold_source,\n    FILE_FORMAT = parquet\n)\nAS\nSELECT DISTINCT\n    ABS(\n        CAST(\n            SUBSTRING(\n                HASHBYTES(\n                    'SHA2_256',\n                    UPPER(TRIM(Promotion))\n                ),\n                1, 8\n            ) AS BIGINT\n        )\n    ) AS PromotionKey,\n    UPPER(TRIM(Promotion)) AS Promotion_Name,\n    Discount_Applied\nFROM silver.retail\nWHERE Promotion IS NOT NULL;\n\n\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "retail_serverless",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}